```shell
PS C:\Users\hp\Desktop\Brand_New_2\video-summarizer-using-transformer-and-pso> ..\myenv\Scripts\python.exe train.py
Dataset: TVSum
Features path: Features/features_TVSum_resnet18_2
Attention model: Luong
Using device: cuda
Initializing VideoDataset...
Found 50 feature files
Max sequence length: 647
C:\Users\hp\Desktop\Brand_New_2\myenv\Lib\site-packages\torch\optim\lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.95it/s]
Epoch: 1, F1 Score: 0.35950577919489834
Epoch 2/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.08it/s] 
Epoch: 2, F1 Score: 0.5012319605772615
Epoch 3/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.59it/s] 
Epoch: 3, F1 Score: 0.47337278106508873
Epoch 4/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.04it/s] 
Epoch: 4, F1 Score: 0.35552012754085294
Epoch 5/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.65it/s] 
Epoch: 5, F1 Score: 0.469236471460341
Epoch 2/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.08it/s] 
Epoch: 2, F1 Score: 0.5012319605772615
Epoch 3/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.59it/s] 
Epoch: 3, F1 Score: 0.47337278106508873
Epoch 4/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.04it/s] 
Epoch: 4, F1 Score: 0.35552012754085294
Epoch 5/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.65it/s] 
Epoch: 5, F1 Score: 0.469236471460341
Epoch 6/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.45it/s] 
Epoch: 2, F1 Score: 0.5012319605772615
Epoch 3/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.59it/s] 
Epoch: 3, F1 Score: 0.47337278106508873
Epoch 4/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.04it/s] 
Epoch: 4, F1 Score: 0.35552012754085294
Epoch 5/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.65it/s] 
Epoch: 5, F1 Score: 0.469236471460341
Epoch: 3, F1 Score: 0.47337278106508873
Epoch 4/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.04it/s] 
Epoch: 4, F1 Score: 0.35552012754085294
Epoch 5/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.65it/s] 
Epoch: 5, F1 Score: 0.469236471460341
Epoch: 4, F1 Score: 0.35552012754085294
Epoch 5/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.65it/s] 
Epoch: 5, F1 Score: 0.469236471460341
Epoch 5/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.65it/s] 
Epoch: 5, F1 Score: 0.469236471460341
Epoch: 5, F1 Score: 0.469236471460341
Epoch 6/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.45it/s] 
Epoch: 6, F1 Score: 0.4555956678700361
Epoch 7/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.73it/s] 
Epoch: 7, F1 Score: 0.3885226832105467
Epoch 8/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.73it/s] 
Epoch: 8, F1 Score: 0.5233644859813084
Epoch 9/40: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.63it/s] 
Epoch: 9, F1 Score: 0.44745762711864406
Epoch 10/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.64it/s] 
Epoch: 10, F1 Score: 0.5343086032741206
Epoch 11/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.63it/s]
Epoch: 11, F1 Score: 0.38018433179723504
Epoch 12/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.75it/s]
Epoch: 12, F1 Score: 0.4759437453737972
Epoch 13/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.73it/s]
Epoch: 13, F1 Score: 0.4638949671772429
Epoch 14/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  6.71it/s]
Epoch: 14, F1 Score: 0.5779694757796947
Epoch 15/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.64it/s]
Epoch: 15, F1 Score: 0.43844984802431614
Epoch 16/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.55it/s] 
Epoch: 16, F1 Score: 0.511204481792717
Epoch 17/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.76it/s] 
Epoch: 17, F1 Score: 0.5022927689594356
Epoch 18/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.45it/s] 
Epoch: 18, F1 Score: 0.535230822631031
Epoch 19/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.73it/s] 
Epoch: 19, F1 Score: 0.4414048059149723
Epoch 20/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.77it/s] 
Epoch: 20, F1 Score: 0.3571143882024711
Epoch 21/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.73it/s] 
Epoch: 21, F1 Score: 0.44124336618650495
Epoch 22/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.75it/s] 
Epoch: 22, F1 Score: 0.4888408927285817
Epoch 23/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.73it/s] 
Epoch: 23, F1 Score: 0.44452858765619085
Epoch 24/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.91it/s]
Epoch: 24, F1 Score: 0.3637801502570186
Epoch 25/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.76it/s]
Epoch: 25, F1 Score: 0.47372210223182143
Epoch 26/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.78it/s]
Epoch: 26, F1 Score: 0.46691449814126396
Epoch 27/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.68it/s]
Epoch: 27, F1 Score: 0.35828025477707004
Epoch 28/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.74it/s]
Epoch: 28, F1 Score: 0.48566243194192377
Epoch 29/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  7.80it/s]
Epoch: 29, F1 Score: 0.4528582034149963
Epoch 30/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.72it/s]
Epoch: 30, F1 Score: 0.5163610212153902
Epoch 31/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.65it/s]
Epoch: 31, F1 Score: 0.4257916825639069
Epoch 32/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.64it/s]
Epoch: 32, F1 Score: 0.5261648745519714
Epoch 33/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.61it/s]
Epoch: 33, F1 Score: 0.4701627486437613
Epoch 34/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.64it/s]
Epoch: 34, F1 Score: 0.5048966267682263
Epoch 35/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.59it/s]
Epoch: 35, F1 Score: 0.4876150035385704
Epoch 36/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.59it/s]
Epoch: 36, F1 Score: 0.4537138675448225
Epoch 37/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.62it/s]
Epoch: 37, F1 Score: 0.5168943206326384
Epoch 38/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  8.13it/s]
Epoch: 38, F1 Score: 0.4587840358075345
Epoch 39/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.64it/s]
Epoch: 39, F1 Score: 0.457977207977208
Epoch 40/40: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10/10 [00:01<00:00,  5.71it/s]
Epoch: 40, F1 Score: 0.542995839112344

Training Metrics:
+-------+--------+-----------+--------+----------+----------+
| Epoch |  Loss  | Precision | Recall | F1-Score | Accuracy |
+-------+--------+-----------+--------+----------+----------+
|   1   | 1.1729 |   0.8656  | 0.2269 |  0.3595  |  0.3076  |
|   2   | 1.1838 |   0.8347  | 0.3581 |  0.5012  |  0.3895  |
|   3   | 1.1641 |   0.8939  | 0.3219 |  0.4734  |  0.3865  |
|   4   | 1.1072 |   0.8560  | 0.2243 |  0.3555  |  0.3033  |
|   5   | 1.1408 |   0.8915  | 0.3184 |  0.4692  |  0.3830  |
|   6   | 1.1653 |   0.8069  | 0.3174 |  0.4556  |  0.3503  |
|   7   | 1.2161 |   0.8477  | 0.2520 |  0.3885  |  0.3206  |
|   8   | 1.2060 |   0.9169  | 0.3662 |  0.5234  |  0.4287  |
|   9   | 1.2247 |   0.8906  | 0.2988 |  0.4475  |  0.3679  |
|   10  | 1.1166 |   0.8686  | 0.3858 |  0.5343  |  0.4240  |
|   11  | 1.1248 |   0.8036  | 0.2490 |  0.3802  |  0.3046  |
|   12  | 1.1002 |   0.9006  | 0.3234 |  0.4759  |  0.3899  |
|   13  | 1.0803 |   0.8435  | 0.3199 |  0.4639  |  0.3667  |
|   14  | 1.1930 |   0.8489  | 0.4381 |  0.5780  |  0.4520  |
|   15  | 1.1598 |   0.8960  | 0.2902 |  0.4384  |  0.3632  |
|   16  | 1.1245 |   0.8410  | 0.3672 |  0.5112  |  0.3985  |
|   17  | 1.1229 |   0.8406  | 0.3581 |  0.5023  |  0.3921  |
|   18  | 1.1201 |   0.8634  | 0.3878 |  0.5352  |  0.4231  |
|   19  | 1.1033 |   0.8326  | 0.3003 |  0.4414  |  0.3490  |
|   20  | 1.1528 |   0.8599  | 0.2254 |  0.3571  |  0.3050  |
|   21  | 1.1766 |   0.8954  | 0.2928 |  0.4412  |  0.3649  |
|   22  | 1.1606 |   0.8595  | 0.3415 |  0.4888  |  0.3882  |
|   23  | 1.1068 |   0.8989  | 0.2953 |  0.4445  |  0.3679  |
|   24  | 1.1769 |   0.8503  | 0.2314 |  0.3638  |  0.3068  |
|   25  | 1.1566 |   0.8329  | 0.3310 |  0.4737  |  0.3701  |
|   26  | 1.1852 |   0.8946  | 0.3159 |  0.4669  |  0.3822  |
|   27  | 1.1455 |   0.8588  | 0.2264 |  0.3583  |  0.3055  |
|   28  | 1.1584 |   0.8722  | 0.3365 |  0.4857  |  0.3895  |
|   14  | 1.1930 |   0.8489  | 0.4381 |  0.5780  |  0.4520  |
|   15  | 1.1598 |   0.8960  | 0.2902 |  0.4384  |  0.3632  |
|   16  | 1.1245 |   0.8410  | 0.3672 |  0.5112  |  0.3985  |
|   17  | 1.1229 |   0.8406  | 0.3581 |  0.5023  |  0.3921  |
|   18  | 1.1201 |   0.8634  | 0.3878 |  0.5352  |  0.4231  |
|   19  | 1.1033 |   0.8326  | 0.3003 |  0.4414  |  0.3490  |
|   20  | 1.1528 |   0.8599  | 0.2254 |  0.3571  |  0.3050  |
|   21  | 1.1766 |   0.8954  | 0.2928 |  0.4412  |  0.3649  |
|   22  | 1.1606 |   0.8595  | 0.3415 |  0.4888  |  0.3882  |
|   23  | 1.1068 |   0.8989  | 0.2953 |  0.4445  |  0.3679  |
|   24  | 1.1769 |   0.8503  | 0.2314 |  0.3638  |  0.3068  |
|   25  | 1.1566 |   0.8329  | 0.3310 |  0.4737  |  0.3701  |
|   26  | 1.1852 |   0.8946  | 0.3159 |  0.4669  |  0.3822  |
|   27  | 1.1455 |   0.8588  | 0.2264 |  0.3583  |  0.3055  |
|   28  | 1.1584 |   0.8722  | 0.3365 |  0.4857  |  0.3895  |
|   29  | 1.1250 |   0.8640  | 0.3068 |  0.4529  |  0.3649  |
|   30  | 1.1005 |   0.9054  | 0.3612 |  0.5164  |  0.4205  |
|   31  | 1.1546 |   0.8815  | 0.2807 |  0.4258  |  0.3516  |
|   32  | 1.1106 |   0.9152  | 0.3692 |  0.5262  |  0.4304  |
|   33  | 1.1289 |   0.8366  | 0.3270 |  0.4702  |  0.3688  |
|   34  | 1.1333 |   0.9051  | 0.3501 |  0.5049  |  0.4119  |
|   35  | 1.2484 |   0.8222  | 0.3466 |  0.4876  |  0.3761  |
|   36  | 1.2203 |   0.8322  | 0.3119 |  0.4537  |  0.3567  |
|   37  | 1.0916 |   0.9055  | 0.3617 |  0.5169  |  0.4209  |
|   38  | 1.1552 |   0.8874  | 0.3094 |  0.4588  |  0.3748  |
|   29  | 1.1250 |   0.8640  | 0.3068 |  0.4529  |  0.3649  |
|   30  | 1.1005 |   0.9054  | 0.3612 |  0.5164  |  0.4205  |
|   31  | 1.1546 |   0.8815  | 0.2807 |  0.4258  |  0.3516  |
|   32  | 1.1106 |   0.9152  | 0.3692 |  0.5262  |  0.4304  |
|   33  | 1.1289 |   0.8366  | 0.3270 |  0.4702  |  0.3688  |
|   34  | 1.1333 |   0.9051  | 0.3501 |  0.5049  |  0.4119  |
|   35  | 1.2484 |   0.8222  | 0.3466 |  0.4876  |  0.3761  |
|   36  | 1.2203 |   0.8322  | 0.3119 |  0.4537  |  0.3567  |
|   37  | 1.0916 |   0.9055  | 0.3617 |  0.5169  |  0.4209  |
|   38  | 1.1552 |   0.8874  | 0.3094 |  0.4588  |  0.3748  |
|   39  | 1.1005 |   0.7841  | 0.3234 |  0.4580  |  0.3442  |
|   40  | 1.1795 |   0.8739  | 0.3939 |  0.5430  |  0.4321  |
+-------+--------+-----------+--------+----------+----------+
```